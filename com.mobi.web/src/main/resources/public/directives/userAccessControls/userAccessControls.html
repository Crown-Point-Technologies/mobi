<!--
  #%L
  com.mobi.web
  $Id:$
  $HeadURL:$
  %%
  Copyright (C) 2016 iNovex Information Systems, Inc.
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #L%
  -->
<div class="user-access-controls">
    <h4>{{dvm.ruleTitle}}</h4>
    <md-switch ng-model="dvm.item.everyone" ng-change="dvm.toggleEveryone()" aria-label="Everyone">Everyone</md-switch>
    <div class="row">
        <div class="col-6">
            <div class="selected-items">
                <div class="d-flex selected-item" ng-repeat="user in dvm.item.selectedUsers track by user.iri">
                    <span class="flex-1 text-truncate">{{user.username}}</span>
                    <a ng-if="user.iri != dvm.lm.currentUserIRI" ng-click="dvm.removeUser(user)"><i class="fa fa-times"></i></a>
                </div>
            </div>
            <div class="selector-container">
                <md-autocomplete hide-label md-no-cache="true" md-min-length="0" md-selected-item="dvm.item.selectedUser" md-search-text="dvm.item.userSearchText" md-selected-item-change="dvm.addUser(user)" md-items="user in dvm.filterUsers(dvm.item.users, dvm.item.userSearchText)" md-item-text="user.username" placeholder="Select a user..." md-floating-label="Test" ng-disabled="dvm.item.everyone">
                    <md-item-template>
                        <span md-highlight-text="dvm.item.userSearchText" md-highlight-flags="i">{{user.username}}</span>
                    </md-item-template>
                    <md-not-found><span class="text-muted">No users to show</span></md-not-found>
                </md-autocomplete>
            </div>
        </div>
        <div class="col-6">
            <div class="selected-items">
                <div class="d-flex selected-item" ng-repeat="group in dvm.item.selectedGroups track by group.iri">
                    <span class="flex-1 text-truncate">{{group.title}}</span>
                    <a ng-click="dvm.removeGroup(group)"><i class="fa fa-times"></i></a>
                </div>
            </div>
            <div class="selector-container">
                <md-autocomplete hide-label md-no-cache="true" md-min-length="0" md-selected-item="dvm.item.selectedGroup" md-search-text="dvm.item.groupSearchText" md-selected-item-change="dvm.addGroup(group)" md-items="group in dvm.filterGroups(dvm.item.groups, dvm.item.groupSearchText)" md-item-text="group.title" placeholder="Select a group..." md-floating-label="Test" ng-disabled="dvm.item.everyone">
                    <md-item-template>
                        <span md-highlight-text="dvm.item.groupSearchText" md-highlight-flags="i">{{group.title}}</span>
                    </md-item-template>
                    <md-not-found><span class="text-muted">No groups to show</span></md-not-found>
                </md-autocomplete>
            </div>
        </div>
    </div>
</div>