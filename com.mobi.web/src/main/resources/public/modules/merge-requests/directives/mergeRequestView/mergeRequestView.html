<!--
  #%L
  com.mobi.web
  $Id:$
  $HeadURL:$
  %%
  Copyright (C) 2016 - 2018 iNovex Information Systems, Inc.
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #L%
  -->
<div class="merge-request-view">
    <block>
        <block-content class="padding">
            <div class="main-details">
                <span class="open-indicator badge badge-pill float-right" ng-class="dvm.mm.isAccepted(dvm.state.selected.request) ? 'badge-success' : 'badge-primary'">{{dvm.mm.isAccepted(dvm.state.selected.request) ? 'Accepted' : 'Open'}}</span>
                <div class="title">
                    <h2>{{dvm.state.selected.title}}</h2>
                    <small>Created on {{dvm.state.selected.date}} by {{dvm.state.selected.creator}}</small>
                </div>
                <div class="description">
                    {{dvm.util.getDctermsValue(dvm.state.selected.request, 'description') || 'No description'}}
                </div>
                <div class="request-summary"><strong>{{dvm.state.selected.sourceTitle}}</strong> into <strong>{{dvm.state.selected.targetTitle ? dvm.state.selected.targetTitle : 'NO TARGET'}}</strong> in <strong>{{dvm.state.selected.recordTitle}}</strong></div>
                <div class="assignees">
                    <span class="field-name">Assignee(s): </span>
                    <ul class="assignees">
                        <li ng-if="dvm.state.selected.assignees.length === 0" class="last">(None specified)</li>
                        <li ng-repeat="assignee in dvm.state.selected.assignees" ng-class="{'last': $last}">{{assignee}}</li>
                    </ul>
                </div>
                <div class="alert alert-warning" role="alert" ng-if="dvm.state.selected.hasConflicts || !dvm.state.selected.targetTitle">
                    <span class="fa fa-exclamation-triangle" />
                    <span ng-if="dvm.state.selected.targetTitle && dvm.state.selected.hasConflicts">This request has conflicts. You can resolve them during the merge process.</span>
                    <span ng-if="!dvm.state.selected.targetTitle">The target branch for this merge request has been deleted.</span>
                </div>
            </div>
            <commit-difference-tabset difference="dvm.state.selected.difference" branch-title="dvm.state.selected.sourceBranchTitle" commit-id="dvm.state.selected.sourceCommit" target-id="dvm.state.selected.targetCommit"></commit-difference-tabset>
        </block-content>
        <block-footer>
            <button class="btn btn-primary float-right" ng-if="!dvm.mm.isAccepted(dvm.state.selected.request)" ng-disabled="dvm.state.selected.hasConflicts || !dvm.state.selected.targetTitle" ng-click="dvm.showAccept()">Accept</button>
            <button class="btn btn-danger float-right" ng-click="dvm.showDelete()">Delete</button>
            <button class="btn float-right" ng-click="dvm.back()">Back</button>
        </block-footer>
    </block>
</div>