<!--
  #%L
  org.matonto.web
  $Id:$
  $HeadURL:$
  %%
  Copyright (C) 2016 iNovex Information Systems, Inc.
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #L%
  -->
<div class="file-upload-overlay overlay xl">
    <form class="content" name="dvm.fileForm">
        <h6>Choose Delimited File</h6>
        <div class="form-group">
            <file-input ng-model="dvm.cm.fileObj" accept=".csv,.xls,.xlsx,.tsv" required></file-input>
        </div>
        <div class="form-group">
            <input type="checkbox" ng-model="dvm.cm.containsHeaders">Contains headers</input>
        </div>
        <div ng-if="dvm.cm.fileObj && !dvm.isExcel()" class="form-group form-inline">
            <h4>Separator</h4>
            <radio-button value="','" ng-model="dvm.cm.separator" display-text="'Comma'"></radio-button>
            <radio-button value="'\t'" ng-model="dvm.cm.separator" display-text="'Tab'"></radio-button>
            <radio-button value="':'" ng-model="dvm.cm.separator" display-text="'Colon'"></radio-button>
        </div>
        <div class="upload-btn form-group btn-container float-container">
            <custom-button on-click="dvm.upload()" pull="'left'" is-disabled-when="!dvm.cm.fileObj" aria-describedby="form-help-block">{{!dvm.fileForm.$error.fileUploaded ? 'Update' : 'Upload'}}</custom-button>
            <span id="form-help-block" class="help-block" ng-if="!dvm.fileForm.$error.fileUploaded">Click update with desired changes or click continue.</span>
        </div>
        <h3 ng-if="dvm.fileForm.$error.fileUploaded" class="error-msg">{{dvm.errorMessage}}</h3>
        <div ng-if="dvm.state.invalidProps.length" class="invalid-props">
            <h3 class="error-msg">Missing Columns</h3>
            <ul>
                <li ng-repeat="columnObj in dvm.state.invalidProps">
                    Column {{columnObj.index + 1}} - {{dvm.getDataMappingName(columnObj['@id'])}}
                </li>
            </ul>
        </div>
        
        <div class="btn-container clearfix">
            <p ng-if="!dvm.state.newMapping" class="help-block">Any changes to the mapping will create a new mapping with a timestamped name</p>
            <custom-button on-click="dvm.cancel()" type="'secondary'" pull="'left'">{{dvm.state.newMapping ? 'Back' : 'Cancel'}}</custom-button>
            <custom-button on-click="dvm.continue()" is-disabled-when="dvm.fileForm.$invalid">{{dvm.state.invalidProps.length ? 'Fix' : 'Continue'}}</custom-button>
        </div>
    </form>
</div>