<!--
  #%L
  org.matonto.web
  $Id:$
  $HeadURL:$
  %%
  Copyright (C) 2016 iNovex Information Systems, Inc.
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #L%
  -->
<div class="tree everything-tree scroll-without-buttons">
    <!-- tree view -->
    <strong>Everything</strong>
    <!-- start ontologies -->
    <ul ng-repeat="(oi, ontology) in dvm.ontologies" ng-init="opened = (dvm.sm.state.oi === oi && (dvm.sm.state.ci !== undefined || dvm.sm.state.pi !== undefined))">
        <tree-item current-entity="ontology"
                   current-ontology="ontology"
                   is-active="dvm.sm.state.oi === $index && dvm.sm.state.ci === undefined && dvm.sm.state.pi === undefined"
                   is-opened="opened"
                   on-click="dvm.sm.selectItem('ontology-editor', $index)"
                   has-children="!!ontology.matonto.classes.length || !!ontology.matonto.noDomains.length"></tree-item>

        <li class="container" ng-show="opened">
            <!-- start classes -->
            <ul ng-repeat="(ci, class) in ontology.matonto.classes" ng-init="subOpened = (dvm.sm.state.ci === ci && dvm.sm.state.pi !== undefined)">
                <tree-item current-entity="class"
                           current-ontology="ontology"
                           is-active="dvm.sm.state.oi === oi && dvm.sm.state.ci === $index && dvm.sm.state.pi === undefined"
                           is-opened="subOpened"
                           on-click="dvm.sm.selectItem('class-editor', oi, $index)"
                           has-children="class.matonto.properties.length"></tree-item>

                <li class="container" ng-show="subOpened">
                    <!-- start properties -->
                    <ul>
                        <tree-item ng-repeat="property in class.matonto.properties"
                                   current-entity="property"
                                   current-ontology="ontology"
                                   is-active="dvm.sm.state.oi === oi && dvm.sm.state.ci === ci && dvm.sm.state.pi === $index"
                                   on-click="dvm.sm.selectItem('property-editor', oi, ci, $index)"></tree-item>
                    </ul>
                </li>
            </ul>

            <!-- start no domains (these will be handled differently later) -->
            <ul ng-if="ontology.matonto.noDomains.length" ng-init="opened = (dvm.sm.state.ci === undefined && dvm.sm.state.pi !== undefined)">
                <li>
                    <a ng-click="opened = !opened; $event.stopPropagation();">
                        <i class="fa fa-fw"
                           ng-class="{'fa-folder-open-o': opened, 'fa-folder-o': !opened}"></i>Properties
                    </a>
                </li>
                <!-- properties without domains -->
                <li class="container" ng-show="opened">
                    <ul>
                        <tree-item ng-repeat="property in ontology.matonto.noDomains"
                                   current-entity="property"
                                   current-ontology="ontology"
                                   is-active="dvm.sm.state.oi === oi && dvm.sm.state.ci === ci && dvm.sm.state.pi === $index"
                                   on-click="dvm.sm.selectItem('property-editor', oi, undefined, $index)"></tree-item>
                    </ul>
                </li>
            </ul>

        </li>
    </ul>
    <!-- end ontologies -->
</div>
